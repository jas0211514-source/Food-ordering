<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel - Spice & Sapore</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
    font-family:'Poppins',sans-serif;
    background:#fff8f3;
    padding:40px;
}

.admin-container{
    max-width:700px;
    margin:auto;
}

.order-card{
    background:white;
    padding:25px;
    border-radius:15px;
    box-shadow:0 5px 20px rgba(0,0,0,0.1);
    margin-bottom:20px;
}

.btn-theme{
    background:#ff6b6b;
    color:white;
    border:none;
}

.btn-theme:hover{
    background:#ff4c4c;
}
</style>
</head>

<body>

<script>
if(localStorage.getItem("role") !== "admin"){
    window.location.href="login.html";
}
</script>

<div class="admin-container">

    <h2 class="text-center mb-4">ğŸ‘‘ Admin Order Dashboard</h2>

    <div class="order-card">
        <h5>ğŸ“¦ Current Order</h5>
        <p id="orderItems"></p>

        <label>Status:</label>
        <select id="statusSelect" class="form-select mb-3">
            <option>ğŸ§‘â€ğŸ³ Order Received</option>
            <option>ğŸ”¥ Preparing Food</option>
            <option>ğŸ Cooking</option>
            <option>ğŸš´ Out for Delivery</option>
            <option>âœ… Delivered</option>
        </select>

        <label>Delivery Time:</label>
        <input type="text" id="deliveryInput" class="form-control mb-3" placeholder="Enter delivery time">

        <button class="btn btn-theme w-100" onclick="updateOrder()">Update Order</button>

        <p class="text-success mt-3 text-center" id="successMsg"></p>
    </div>

    <div class="text-center">
        <button class="btn btn-danger" onclick="logout()">Logout</button>
    </div>

</div>



<script>



// Protect admin page
if(localStorage.getItem("role") !== "admin"){
    window.location.href="login.html";
}

const container = document.getElementById("orderItems");

function loadOrders(){

    let orders = JSON.parse(localStorage.getItem("allOrders")) || [];

    if(orders.length === 0){
        container.innerHTML = "No Orders Yet ğŸ˜…";
        return;
    }

    container.innerHTML = "";

    orders.forEach((order,index)=>{

        container.innerHTML += `
        <div style="border:1px solid #ddd;padding:15px;margin-bottom:15px;border-radius:10px;">
            <h5>ğŸ“¦ Order ID: ${order.id}</h5>
            <p><strong>Items:</strong><br>${order.items}</p>
            <p><strong>Payment:</strong> ${order.payment}</p>
            <p><strong>OTP:</strong> ${order.otp}</p>
            <p><strong>Status:</strong> ${order.status}</p>
            <p><strong>Delivery Time:</strong> ${order.deliveryTime || "Not set"}</p>

            <select onchange="updateStatus(${index}, this.value)" class="form-select mb-2">
                <option>ğŸ§‘â€ğŸ³ Order Received</option>
                <option>ğŸ”¥ Preparing Food</option>
                <option>ğŸ Cooking</option>
                <option>ğŸš´ Out for Delivery</option>
                <option>âœ… Delivered</option>
            </select>

            <input type="text" placeholder="Delivery Time" 
                onchange="updateTime(${index}, this.value)" 
                class="form-control">
        </div>
        `;
    });
}

function updateStatus(index,value){
    let orders = JSON.parse(localStorage.getItem("allOrders")) || [];
    orders[index].status = value;
    localStorage.setItem("allOrders", JSON.stringify(orders));
    loadOrders();
}

function updateTime(index,value){
    let orders = JSON.parse(localStorage.getItem("allOrders")) || [];
    orders[index].deliveryTime = value;
    localStorage.setItem("allOrders", JSON.stringify(orders));
    loadOrders();
}

function logout(){
    localStorage.removeItem("role");
    window.location.href="login.html";
}

loadOrders();

</script>



</body>
</html>